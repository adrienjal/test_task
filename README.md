# Empirical Moments Analysis - Outputs

## Repository Purpose

This repository hosts the outputs generated by the **`sj_submissions_empirical_moments.ipynb`** notebook from the "Empirical Moments of Housing Submissions in San José" analysis.

Its primary function is to serve as a public host for the visualizations and maps, allowing them to be embedded directly into the final HTML summary document.

## Output

The `outputs/Submissions/` folder contains the following:

### `Datasets`

This folder contains the final empirical moments datasets in two formats, as well as intermediate files.

-   **`submissions_moments_split_census_san_jose.csv`**: The primary output dataset in CSV format, containing calculated empirical moments for each census tract. It includes both yearly data (2018–2024) and an aggregate "All" years view.
-   **`submissions_moments_split_census_san_jose.gpkg`**: The same dataset in GeoPackage format, which includes the census tract geometries for GIS analysis.

The datasets contain the following key columns:
-   **Project Counts**:
    -   `projectCount`: The total number of unique housing projects submitted within the tract and year.
    -   `projectCount_MF`, `projectCount_SF`: The number of projects classified as Multi-Family and Single-Family, respectively.
-   **Unit Quantities (`q...`)**:
    -   `qTot`: Total number of proposed units across all projects.
    -   `qAffordable`: Total number of affordable units.
    -   `qAboveMarket`: Total number of market-rate units.
    -   `qMFa`, `qSFa`, `qMFm`, `qSFm`: Unit quantities broken down by type (MF/SF) and affordability (a/m). For example, `qMFa` is the quantity of affordable multi-family units.
-   **Share of Renter-Occupied Units (`shareRent...`)**:
    -   These columns represent the share of units within a specific category that are designated for renters. For example, `shareRentMFa` is the proportion of *affordable multi-family units* (`qMFa`) that are renter-occupied.

-   **`Intermediate_Datasets/`**:
    -   `apr_data_san_jose_gdf_combined_projects.csv`: An intermediate dataset where projects with the same submission date and location have been aggregated.

### `Maps`

This folder contains a series of interactive HTML maps. Separate maps are generated for each year from 2018 to 2024, plus an aggregate map for all years.

-   **`affordable_units_split_census_tracts_{year}.html`**: A map for a specific year (e.g., `..._2024.html`).
-   **`affordable_units_split_census_tracts_all.html`**: A map aggregating data across all years.

Each map shows:
-   Census tracts colored by the total number of proposed units.
-   Red dots indicating the number of affordable units in a tract (larger dots mean more units).
-   **Interactive Details**: Hovering over a tract or clicking a dot reveals more information, such as project and unit counts.

### `Visualizations`

This folder contains plots for different geographic areas, with each jurisdiction in its own subfolder. The plots include:
-   **`yearly_submissions_comparison_{jurisdiction}.png`**: A 3x3 grid of bar charts showing the evolution of project submissions, total units, and affordable units.
-   **`yearly_submissions_comparison_by_unit_type_{jurisdiction}.png`**: A stacked bar chart showing the breakdown of project submissions by unit category.

## Workflow and Usage

The entire set of outputs in this repository is generated by the `sj_submissions_empirical_moments.ipynb` notebook. After being generated, these files are uploaded here.

A separate script, `html_doc_creation.ipynb`, then uses the public URLs of the files in this repository to assemble the final, comprehensive HTML report (`affordable_housing_summary_san_jose.html`). This ensures the interactive maps and visualizations are correctly embedded and accessible.

## Source Code Location

The source code for the analysis that produces these outputs is located in the main project directory at:https://github.com/JunbiaoChen1998/zoning/tree/main/tasks/empirical_moments/san_jose_moments/code
